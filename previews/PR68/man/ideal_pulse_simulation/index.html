<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ideal Pulse Simulation · LegendGeSim</title><meta name="title" content="Ideal Pulse Simulation · LegendGeSim"/><meta property="og:title" content="Ideal Pulse Simulation · LegendGeSim"/><meta property="twitter:title" content="Ideal Pulse Simulation · LegendGeSim"/><meta name="description" content="Documentation for LegendGeSim."/><meta property="og:description" content="Documentation for LegendGeSim."/><meta property="twitter:description" content="Documentation for LegendGeSim."/><meta property="og:url" content="https://legend-exp.github.io/LegendGeSim.jl/stable/man/ideal_pulse_simulation/"/><meta property="twitter:url" content="https://legend-exp.github.io/LegendGeSim.jl/stable/man/ideal_pulse_simulation/"/><link rel="canonical" href="https://legend-exp.github.io/LegendGeSim.jl/stable/man/ideal_pulse_simulation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LegendGeSim</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../LegendGeSim/">The LEGEND Germanium Simulation Chain</a></li><li><a class="tocitem" href="../field_simulation/">Field Simulation</a></li><li class="is-active"><a class="tocitem" href>Ideal Pulse Simulation</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#1.-LEGEND-detector-metadata"><span>1. LEGEND detector metadata</span></a></li><li><a class="tocitem" href="#2.-PET-input-file"><span>2. PET input file</span></a></li><li><a class="tocitem" href="#3.-Environemnt-settings"><span>3. Environemnt settings</span></a></li><li><a class="tocitem" href="#4.-Simulation-settings"><span>4. Simulation settings</span></a></li><li><a class="tocitem" href="#5.-Noise-model"><span>5. Noise model</span></a></li></ul></li><li><a class="tocitem" href="../realistic_waveform_simulation/">Realistic Waveform Simulation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/detector_geometry/">Detector Geometry</a></li><li><a class="tocitem" href="../../tutorials/simulate_fields/">Simulate Fields</a></li><li><a class="tocitem" href="../../tutorials/simulate_ideal_pulses/">Simulate Ideal Pulses</a></li><li><a class="tocitem" href="../../tutorials/simulate_realistic_waveforms/">Simulate Realistic Waveforms</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Ideal Pulse Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ideal Pulse Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendGeSim.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/legend-exp/LegendGeSim.jl/blob/main/docs/src/man/ideal_pulse_simulation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Ideal-Pulse-Simulation"><a class="docs-heading-anchor" href="#Ideal-Pulse-Simulation">Ideal Pulse Simulation</a><a id="Ideal-Pulse-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Ideal-Pulse-Simulation" title="Permalink"></a></h1><p>As inputs to ideal pulse simulation you should provide</p><ol><li><p>LEGEND detector metadata</p></li><li><p>PET input file</p></li><li><p>Environment settings</p></li><li><p>Simulation settings</p></li><li><p>Noise model</p></li></ol><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">detector_metadata_filename = &quot;path/to/legend-detectors/germanium/diodes/V04545A.json&quot;

pet_input_file = &quot;/lfs/l1/legend/detector_char/enr/hades/simulations/legend-g4simple-simulation/simulations/V04545A/am_HS1/top_46r_4z/hdf5/sim-V04545A-am_HS1-top-46r-4z-01.hdf5&quot;

environment_settings = Dict(
    &quot;crystal_temperature_in_K&quot; =&gt; 77, 
    &quot;medium&quot; =&gt; &quot;vacuum&quot;, 
    &quot;dl&quot; =&gt; &quot;vendor&quot; # optional, default 0
    &quot;operating_voltage_in_V&quot; =&gt; 5000, # optional, default recV from metadata
)

simulation_settings = Dict(
    &quot;method&quot; =&gt; &quot;SSD&quot;,
    &quot;cached_name&quot; =&gt; &quot;test&quot;,
    &quot;crystal_metadata_path&quot; =&gt; &quot;path/to/legend-detectors/germanium/crystals&quot;,
    &quot;time_step&quot; =&gt; 2, #ns
    &quot;diffusion&quot; =&gt; true,
    &quot;self-repulsion&quot; =&gt; true,
    &quot;num_carriers&quot; =&gt; 10
)

noise_model = Dict(
    &quot;type&quot; =&gt; &quot;sim&quot;
)

pss_table, pss_truth = LegendGeSim.simulate_pulses(detector_metadata_filename, pet_input_file, environment_settings, simulation_settings, noise_model; n_waveforms=100)</code></pre><p>The optional variable <code>n_waveforms</code> defines how many waveforms will be simulted based on the given <code>pet</code> file. Not providing the variable will default <code>0</code> meaning, simulate all waveforms in the <code>pet</code> input file.</p><p>The output: <code>pss_table</code> contains the following fields:</p><ul><li><code>channel</code>: currently, ID of the contact (1 for p+ contact, 2 for n+ contact)</li><li><code>ievt</code>: event number</li><li><code>waveform</code>: waveform in format of <code>RDWaweform</code> from <code>RadiationDetectorSignals.jl</code>. Contains fields <code>time</code> and <code>signal</code>.</li></ul><p><code>pss_truth</code> contains a copy of the information in the <code>pet</code> input file for convenience (to compare)</p><h2 id="1.-LEGEND-detector-metadata"><a class="docs-heading-anchor" href="#1.-LEGEND-detector-metadata">1. LEGEND detector metadata</a><a id="1.-LEGEND-detector-metadata-1"></a><a class="docs-heading-anchor-permalink" href="#1.-LEGEND-detector-metadata" title="Permalink"></a></h2><p>To obtain JSONs for all LEGEND detectors you can clone the repository <code>legend-detectors</code>. The JSONs can be found under <code>germanium/diodes</code>. You may also create your custom detector JSON file as long as it follows the LEGEND detector metadata format (see README in <code>diodes/</code>).</p><h2 id="2.-PET-input-file"><a class="docs-heading-anchor" href="#2.-PET-input-file">2. PET input file</a><a id="2.-PET-input-file-1"></a><a class="docs-heading-anchor-permalink" href="#2.-PET-input-file" title="Permalink"></a></h2><p>The <code>pet</code> input file contains information on <code>p</code>osition, <code>e</code>nergy amd <code>t</code>ime of the depositions.</p><p>Current available formats:</p><ul><li><p><code>g4simple</code> output in <code>hdf5</code> format. The <code>g4simple</code> simulations of HADES characterization data are available on MPIK under <code>/lfs/l1/legend/detector_char/enr/hades/simulations/legend-g4simple-simulation/simulations/</code>. Consult the <code>legend-g4simple-simulation</code> package to simulate your own custom <code>pet</code> input for given detector and source.</p></li><li><p><code>Geant4</code> output in <code>csv</code> format. See example in <a href="https://github.com/legend-exp/legend-testdata/">legend-testdata</a> under <code>data/ldsim/single-invcoax-th228-geant4.csv</code></p></li></ul><p>Here we will use an example <code>pet</code> file <code>csv</code> format from <code>LegendTestData</code> corresponding to the Public Inverted Coax.</p><h2 id="3.-Environemnt-settings"><a class="docs-heading-anchor" href="#3.-Environemnt-settings">3. Environemnt settings</a><a id="3.-Environemnt-settings-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Environemnt-settings" title="Permalink"></a></h2><p>See <a href="../field_simulation/#Field-Simulation">Field Simulation</a> manual for more details</p><h2 id="4.-Simulation-settings"><a class="docs-heading-anchor" href="#4.-Simulation-settings">4. Simulation settings</a><a id="4.-Simulation-settings-1"></a><a class="docs-heading-anchor-permalink" href="#4.-Simulation-settings" title="Permalink"></a></h2><p>Simulation settings contain settings related to field simulation (see <a href="../field_simulation/#Field-Simulation">Field Simulation</a> manual) + pulse simulation settings.</p><p>Options related to pulse simulation:</p><ul><li><code>&quot;time_step&quot;</code>: time step in nanoseconds, default 1ns</li><li><code>&quot;diffusion&quot;</code>: setting for cloud charge simulation. Default <code>false</code> (point charges)</li><li><code>&quot;self_repulsion&quot;</code>: setting for cloud charge simulation. Default <code>false</code> (point charges)</li><li><code>&quot;number_of_carriers&quot;</code>: setting for cloud charge simulation. Default <code>1</code> (point charges)</li></ul><h2 id="5.-Noise-model"><a class="docs-heading-anchor" href="#5.-Noise-model">5. Noise model</a><a id="5.-Noise-model-1"></a><a class="docs-heading-anchor-permalink" href="#5.-Noise-model" title="Permalink"></a></h2><p>At this stage of the simulation, the noise model regards fano noise of the germanium crystal. The options are simply to simulate the noise or not.</p><p>If you would like to simulate fano noise, provide</p><pre><code class="language-julia hljs">noise_model = Dict( &quot;type&quot; =&gt; &quot;sim&quot; )</code></pre><p>If you do not want to simulate fano noise, simply do not provide <code>noise_model</code> to to <code>simulate_pulses()</code> (it will default to <code>&quot;type&quot; =&gt; &quot;none&quot;</code>)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../field_simulation/">« Field Simulation</a><a class="docs-footer-nextpage" href="../realistic_waveform_simulation/">Realistic Waveform Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 20 November 2024 15:15">Wednesday 20 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
